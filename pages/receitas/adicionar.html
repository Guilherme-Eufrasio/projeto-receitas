<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="../../css/adicionar.css">
    <title>Adicionar</title>
</head>
<body>
    <form name="formAddReceita" id="formAddReceita" >
        <input type="text" id="nomeReceita" class="nomereceita" placeholder="Nome da Receita">
        <input type="url" id="imagemReceita" class="image" placeholder="Link da imagem da receita">
        <input type="text" id="receita" class="descricao" placeholder="Receita">
        <p id="escolha">POPULAR? </p>
        <select name="popularesReceita" id="popularesReceita" class="popular">
            <option value="sim">SIM</option>
            <option value="nao">N√ÉO</option>
        </select>
        <div class="organizar_itens">
            <p>CATEGORIA:</p>
            <select name="categoria" id="categoria" class="categoria">
                <option value="salgado">Salgado</option>
                <option value="doce">Doce</option>
            </select>
        </div>
        <br/>
        <br>
        <div class="butao">
            <button onclick="adicionarReceita()" class="add">Adicionar</button>
        </div>
        
    </form>




    <script>
        const data = localStorage.getItem("receitas");  
        receitas = data ? JSON.parse(data) : [];

        function adicionarReceita(){
            
            let nomereceita = document.getElementById("nomeReceita").value
            let receitaDescricao = document.getElementById("receita").value
            let imagem = document.getElementById("imagemReceita").value
            let popularesReceita = document.getElementById("popularesReceita").value 
            let idUsu = JSON.parse(localStorage.getItem("usuarioLogado")).id
            if (!localStorage.getItem("receitas")) {
                const response =  fetch("../dados/receitas.json");
                const dadosIniciais = response.json();
                localStorage.setItem("jsonCarregado", 'true');    
                localStorage.setItem("receitas", JSON.stringify(dadosIniciais));
            }

            const novoReceita = {
                nome:nomereceita,
                img:imagem,
                receita:receitaDescricao,
                populares:popularesReceita,
                idUsuario: idUsu,
                publicado: "nao"
              };
              

              receitas.push(novoReceita);
              salvarReceita();
        }
        function salvarReceita() {
          localStorage.setItem("receitas", JSON.stringify(receitas));
          window.location.href = "index.html";
        }
    </script>
</body>
</html>